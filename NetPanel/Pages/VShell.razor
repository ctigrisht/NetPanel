@page "/vshell"
@using System.Diagnostics
@using MongoDB.Driver
@using NetPanel.Data
<div class="container" style="display: table-cell; justify-content: center">
    <h2>Shell</h2>
    <p>@ShellContent</p>
    <hr/>
    <ul>
        @foreach (var i in CommandHist)
        {
            <li>@i</li>
        }
    </ul>
    <hr/>
    <textarea placeholder="Enter linux command"></textarea>
    <button class="btn btn-outline-info" @onclick="@(() =>
                                                   {
                                                       try
                                                       {
                                                           ExecuteShell();
                                                       }
                                                       catch (Exception e)
                                                       {
                                                           info = e.ToString();
                                                       }
                                                   })">Execute</button>
    
    <hr/>
    <label></label>
</div>
@code {
    string info = string.Empty;
    public void ExecuteShell()
    {
        ProcessStartInfo startInfo = new ProcessStartInfo() { FileName = "/bin/bash", Arguments = $"{Command}", };
        Process proc = new Process() { StartInfo = startInfo, };

        Task.Run(() =>
        {
            proc.Start();
            while (!proc.HasExited)
            {
                
            }
        });

        proc.Dispose();
    }

    List<string> CommandHist = new List<string>();

    static string ShellContent = string.Empty;
    string Command = string.Empty;
}
